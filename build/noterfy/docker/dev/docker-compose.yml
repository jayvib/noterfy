version: "3.8"

# ⚠⚠⚠ This compose file is use for development purpose only.

services:
  noterfy-engine:
    image: noterfy:dev
    build:
      context: ../../../../
      dockerfile: build/noterfy/docker/Dockerfile
      labels:
        com.noterfy.description: "The applications backend engine"
        com.noterfy.stage: "Development"
    ports:
      - "50001:50001"
    networks:
      - noterfy-backend
    volumes:
      - type: volume
        source: noterfy-volume
        target: /etc/noterfy/data
    secrets:
      - source: noterfy-secret
        target: config.yaml
    env_file:
      - ./noterfy.env
    healthcheck:
      disable: true # Need to be implemented
#      test: ["CMD", "curl", "-f", "http://localhost:50001/health"]
#      interval: 5m
#      timeout: 10s
#      retries: 3
#      start_period: 40s

networks:
  noterfy-backend:

volumes:
  noterfy-volume:

secrets:  # Use for stack. But for development will just use the volume bind
  noterfy-secret:
    file: ./config.yaml

